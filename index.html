<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>BRAND√ÉO BARBER</title>
    <style>
        body { background: #0A0A0A; color: white; font-family: Arial; padding: 20px; }
        .horario-btn { padding: 10px; margin: 5px; border: none; color: white; cursor: pointer; width: 70px; }
        .disponivel { background: green; }
        .indisponivel { background: red; cursor: not-allowed; }
        .selecionado { background: #C0C0C0 !important; color: black; }
        #horariosContainer { display: flex; flex-wrap: wrap; gap: 5px; margin: 20px 0; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>BRAND√ÉO BARBER</h1>
    
    <input type="text" id="nome" placeholder="Seu nome">
    <input type="text" id="whatsapp" placeholder="WhatsApp">
    <select id="servico">
        <option value="Corte">Corte</option>
        <option value="Barba">Barba</option>
    </select>
    <input type="date" id="data" value="2026-02-20">
    
    <div id="horariosContainer"></div>
    <input type="hidden" id="horarioSelecionado">
    
    <button id="btnAgendar">AGENDAR</button>

    <script>
        // üî¥ COLE SUA URL DO SHEETDB AQUI
        const API_URL = 'https://sheetdb.io/api/v1/xxxxx'; // Substitua!
        
        const horarios = ['09:00','09:30','10:00','10:30','11:00','15:00','15:30','16:00','16:30','17:00'];

        async function carregarHorarios() {
            const data = document.getElementById('data').value;
            const res = await fetch(API_URL);
            const agendamentos = await res.json();
            
            const ocupados = agendamentos.filter(a => a.data === data).map(a => a.horario);
            console.log('Hor√°rios ocupados:', ocupados);
            
            const container = document.getElementById('horariosContainer');
            container.innerHTML = '';
            
            horarios.forEach(horario => {
                const btn = document.createElement('button');
                btn.className = `horario-btn ${ocupados.includes(horario) ? 'indisponivel' : 'disponivel'}`;
                btn.textContent = horario;
                btn.disabled = ocupados.includes(horario);
                
                btn.onclick = () => {
                    document.querySelectorAll('.horario-btn').forEach(b => b.classList.remove('selecionado'));
                    btn.classList.add('selecionado');
                    document.getElementById('horarioSelecionado').value = horario;
                };
                
                container.appendChild(btn);
            });
        }

        document.getElementById('data').addEventListener('change', carregarHorarios);
        
        document.getElementById('btnAgendar').onclick = async () => {
            const dados = {
                nome: document.getElementById('nome').value,
                whatsapp: document.getElementById('whatsapp').value,
                servico: document.getElementById('servico').value,
                data: document.getElementById('data').value,
                horario: document.getElementById('horarioSelecionado').value
            };
            
            if (!dados.horario) return alert('Selecione um hor√°rio!');
            
            await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dados)
            });
            
            alert('Agendado!');
            carregarHorarios();
        };
        
        carregarHorarios();
    </script>
</body>
</html>
